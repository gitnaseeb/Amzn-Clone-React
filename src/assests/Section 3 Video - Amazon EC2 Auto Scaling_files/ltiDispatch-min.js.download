/*! Copyright 2003-2022 Rustici Software, LLC All Rights Reserved. Rustici-Engine 21.1.1 2023-10-04T17:24:19+0000 4e6e4eb ltiDispatch */

window.getQueryStringParameter=function(t,e){for(var n,r=function(t){var e;if(!t)return window.location.search.substring(1);if((e=t.split("?")).length<2)return"";if(2<e.length)throw new Error("Malformed URL: "+t);return e[0]}(e).split("&"),o=0;o<r.length;o+=1)if((n=r[o].split("="))[0]===t)return decodeURIComponent(n[1])},window.LtiState=function(){function i(){this.score=null,this.status=t[0][1]}var t=[["unknown",window.LESSON_STATUS_NOT_ATTEMPTED],["incomplete",window.LESSON_STATUS_INCOMPLETE],["completed",window.LESSON_STATUS_COMPLETED],["failed",window.LESSON_STATUS_FAILED],["passed",window.LESSON_STATUS_PASSED]];return i.prototype={scoreIsKnown:function(){return null!==this.score},getScore:function(){return this.score},setScore:function(t){this.score=t},getStatus:function(){return this.status},getStatusValue:function(){var e=this.status;return t.filter(function(t){return t[1]===e})[0][0]}},t.forEach(function(t){var e,n=t[0],r=t[1],o=(e=n).charAt(0).toUpperCase()+e.slice(1);i.prototype["setStatus"+o]=function(){this.status=r},i.prototype["isStatus"+o]=function(){return this.status===r}}),i}(),window.setupDriverForLti=function(r){var t=getQueryStringParameter("redirectOnExitUrl"),o=new LtiState,i=getQueryStringParameter("ltiOutcomeUrl");t&&(r.EXIT_TARGET=t),r.strLMSStandard="NONE",r.NONE_GetStudentID=function(){var t=getQueryStringParameter("studentId");return r.WriteToDebug("In LTI GetStudentID, returning "+t),t},r.NONE_GetStudentName=function(){var t=getQueryStringParameter("studentName").replace(/\+/g," ");return r.WriteToDebug("In LTI GetStudentName, returning "+t),t},r.NONE_GetScore=function(){var t=o.getScore();return r.WriteToDebug("In LTI GetScore, returning "+t),t},r.NONE_SetScore=function(t){var e;return r.WriteToDebug("In LTI SetScore, Returning true"),e=r.RoundToPrecision(t/100,7),o.setScore(e),!0},r.NONE_ResetStatus=function(){return r.WriteToDebug("In LTI ResetStatus"),o.setStatusUnknown(),!0},r.NONE_SetFailed=function(){return r.WriteToDebug("In LTI SetFailed"),o.setStatusFailed(),!0},r.NONE_SetPassed=function(){return r.WriteToDebug("In LTI SetPassed"),o.setStatusPassed(),!0},r.NONE_SetCompleted=function(){return r.WriteToDebug("In LTI SetCompleted, Returning true"),o.setStatusCompleted(),!0},r.NONE_GetStatus=function(){var t=o.getStatus();return r.WriteToDebug("In LTI GetStatus, Returning "+t),t},r.NONE_Finish=function(){return r.WriteToDebug("In LTI Finish, Returning true"),r.CommitData(),!0},i&&(r.NONE_CommitData=function(){var t,e,n=new XMLHttpRequest;if(o.scoreIsKnown())t=o.getScore(),r.WriteToDebug("In LTI CommitData, score set, reporting "+t);else if(o.isStatusPassed())r.WriteToDebug("In LTI CommitData, no score, passed, reporting 1"),t=1;else if(o.isStatusFailed())r.WriteToDebug("In LTI CommitData, no score, failed, reporting 0"),t=0;else{if(!o.isStatusCompleted())return r.WriteToDebug("In LTI CommitData, no score or status set, nothing to commit."),!0;r.WriteToDebug("In LTI CommitData, no score, no success status, complete, reporting 1"),t=1}return n.open("POST",i.replace("_SCORE_",t).replace("_STATE_",o.getStatusValue()),!1),n.send(null),200===n.status||(e="Failed to report score to 3rd-party LMS (data may have been lost)",n.responseText&&(e+="\n\n"+n.responseText),alert(e),!1)})},window.setupDispatchForLti=function(){var t,n=window,r=window,e=window,o=getQueryStringParameter("config"),i=JSON.parse(o);r.DispatchRoot=(t=i.dispatchRoot,"https:"===window.location.protocol?t.replace("http:","https:"):t.replace("https:","http:")),r.DispatchVersion=i.dispatchVersion,r.ContentURL=i.contentUrl,r.PreLaunchConfigurationURL=i.preLaunchConfigurationUrl,r.IsLtiDispatch=!0,e.DispatchStart=function(){var t=void 0!==n.Start,e=void 0!==r.LoadContent;t&&e?(setupDriverForLti(n),void 0!==n.ShowDebugWindow&&n.DebugMode&&n.ShowDebugWindow(),n.Start()):setTimeout(r.DispatchStart,500)},e.DispatchUnload=function(){n.WriteToDebug("Unloading from DispatchUnload"),n.Unload(),n.WriteToDebug("Unloaded from DispatchUnload")}};
//# sourceMappingURL=ltiDispatch-min.js.map