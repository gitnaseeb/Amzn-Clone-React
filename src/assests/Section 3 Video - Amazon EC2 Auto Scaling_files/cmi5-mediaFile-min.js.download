/*! Copyright 2003-2022 Rustici Software, LLC All Rights Reserved. Rustici-Engine 21.1.1 2023-10-04T17:28:24+0000 4e6e4eb Media File Content */

function isParentCrossOrigin(e){var t;try{t=e.parent.location.origin!==e.location.origin}catch(e){t=!0}return t}function getPlayerWindow(){var e=0,t=window;if(void 0!==t.opener&&null!==t.opener){if(void 0!==t.opener.Control&&null!==t.opener.Control)return t.opener;if(void 0!==t.opener.parent&&null!==t.opener.parent&&void 0!==t.opener.parent.Control&&null!==t.opener.parent.Control)return t.opener.parent}for(;(void 0===t.Control||null===t.Control)&&null!==t.parent&&t.parent!==t&&e<=500&&!isParentCrossOrigin(t);)e+=1,t=t.parent;return void 0===t.Control||null===t.Control?null:t}function getReferenceToControlObject(e){var t=getPlayerWindow();if(null!==t)return t.Control;if(e)return null;throw alert("Could not locate the control object."),new Error("Could not locate the control object.")}function getReferenceToIntegrationImplementationObject(e){var t=getPlayerWindow();if(null!==t&&void 0!==t.IntegrationImplementation&&null!==t.IntegrationImplementation)return t.IntegrationImplementation;if(e)return null;throw alert("Could not locate the integration implementation object."),new Error("Could not locate the integration implementation object.")}var auRunner={};!function(){"use strict";function c(e){var t,n=w.get("intervalPerGroupOfStatements");return 0===C?e:(t=Math.floor(Date.now()/1e3/n).toString(16)).length<C?t+e.substring(t.length):t.substring(t.length-C)+e.substring(C)}function d(e,t){return""!==e&&-1===t.indexOf(e)}function p(e){return e+"?version="+w.get("version")+"-"}function r(e){var t={},n={};return auRunner.appendStatementProperties(t,n,e).then(function(){return{context:{extensions:t},target:{definition:{type:auRunner.getActivityType()}},result:{extensions:n}}})}function o(){return auRunner.appendSaveStateContents({isComplete:f}).then(function(e){return new Promise(function(t,n){g.getLRS().saveState("mediaContentStatus",JSON.stringify(e),{agent:v.agent,activity:v.activity,registration:v.registration,callback:function(e){null===e?t():n(e)}})})})}function i(e){var t,n=!1!==e;return auRunner.getProgress().then(function(e){if(-1===e)return auRunner.displayError("The media file's 'duration' was set to 0. It is likely that the file's metadata is missing or corrupted."),void clearInterval(l);try{g.setProgress(Math.round(100*e))}catch(e){console.warn(e)}1===parseFloat(e)&&clearInterval(l),E<=e&&!f&&(f=!0,r().then(function(e){R?((t=g.completedStatement(e)).id=c(t.id),S.push(t)):g.completed(function(e){null!==e&&(f=!1,auRunner.displayError("Error sending 'completed' statement: "+e))},e),n&&o().catch(function(e){auRunner.displayError("Error saving current state: "+e)})}))})}function n(e){var t,n={};return R=!0,y?(void 0!==e&&(n.callback=e),h?Promise.resolve():(m=!0,auRunner.preTerminate(),i(!1).then(o).then(function(){return r(!0)}).then(function(e){(t=g.terminatedStatement(e)).id=c(t.id),S.push(t),g.getLRS().saveStatements(S,n),h=!0}).catch(function(e){auRunner.displayError("Error saving current state: "+e)}))):(m=!0,auRunner.closeAU(),Promise.resolve())}function u(){var e=document.getElementById("rscpAu-ToolbarInfo"),t=document.getElementById("rscpAu-CloseBtn");null===t&&((t=document.createElement("button")).id="rscpAu-CloseBtn",t.innerHTML=auRunner.translate("Close"),t.onclick=function(){confirm(auRunner.translate("Would you like to exit the course now?"))&&n().then(function(){auRunner.closeAU()})},e.appendChild(t))}function a(){var u,e;u="function"==typeof fetch&&"keepalive"in new Request(""),e=window.navigator&&"function"==typeof window.navigator.sendBeacon,t||!u&&!e||(t=!0,g.getLRS()._makeRequest=function(e,t,n){var r,o,i=[],a=e;for(o in n.params)n.params.hasOwnProperty(o)&&i.push(o+"="+encodeURIComponent(n.params[o]));a=g.getLRS()._IEModeConversion(a,t,i,n),r={mode:"cors",cache:"no-cache",credentials:"include",keepalive:!0,method:n.method,headers:{"Content-Type":t["Content-Type"]},body:n.data};try{return u?fetch(a,r).then(function(e){g.log("Overridden request Fetch with KeepAlive finished with status "+e.status+":"+e.statusText)}).catch(function(e){g.log("Overridden request Fetch with KeepAlive returned error: "+e.message)}):window.navigator.sendBeacon(a,n.data),void 0!==n.callback&&n.callback(null,null),{err:null}}catch(e){return g.log("Overridden request Fetch with KeepAlive threw error: "+e.message),{err:e.message,xhr:null}}}),h||n(function(e){null===e?h=!0:auRunner.displayError("Error sending 'terminate' statement: "+e)})}var g,l,s,m=!1,h=!1,f=!1,y=!1,v={},w=getPlayerWindow().rscpCfg,C=w.get("charsToReplace"),E=w.get("mediaContentCompletionThreshold")/100,R=!1,S=[],t=!1;auRunner.prepareAndSendStatement=function(t,e,n,r){var o,i,a,u,l=!1,s=r||{};if(h)auRunner.displayError("A 'Terminated' statement has already been sent. Further statements can not be sent.");else{for(a in o=g.prepareStatement(t),s.verbDisplay&&(o.verb.display=s.verbDisplay),e)e.hasOwnProperty(a)&&(o.context.extensions[a]=e[a]);for(a in n)if(n.hasOwnProperty(a)){l=!0;break}if(l){for(a in(i=new TinCan.Result).extensions={},n)n.hasOwnProperty(a)&&(i.extensions[a]=n[a]);o.result=i}s.category&&((u=o.context.contextActivities.category||[]).push(s.category),o.context.contextActivities.category=u),s.target&&(o.target=s.target),s.duration&&(o.result.duration=s.duration)}o.id=c(o.id),R?S.push(o):g.sendStatement(o,function(e){null!==e&&auRunner.displayError("Error sending the xAPI statement - "+t+" : "+e)})},auRunner.displayError=function(e){var t,n=document.getElementById("rscpAu-ErrorContainer"),r=document.getElementsByClassName("hide-on-error")[0],o=document.getElementById("viewerContainer"),i=document.getElementById("viewer"),a=document.createTextNode(e);u(),null===n&&((n=document.createElement("div")).id="rscpAu-ErrorContainer",(t=document.createElement("p")).innerHTML=auRunner.translate("We apologize, an error has occurred."),n.appendChild(t)),n.appendChild(a),document.body.insertBefore(n,r),null!=o&&(o.style.visibility="hidden",i.style.visibility="hidden"),null!=r&&(r.style.visibility="hidden")},auRunner.closeAU=function(){m?window.location.replace(s):n()},auRunner.translate=function(e){return getPlayerWindow().IntegrationImplementation.GetString(e)};try{g=new Cmi5(document.location.href)}catch(e){return auRunner.displayError("Error creating the cmi5 object: "+e)}g.start(function(e){var t;if(null===e){v={agent:g.getActor(),activity:g.getActivity(),registration:g.getRegistration(),sessionId:g.getSessionId()};try{t=JSON.parse(g.getLaunchParameters())}catch(e){return void auRunner.displayError("Error attempting to parse launch parameters: "+e)}document.title=t.contentTitle,document.getElementById("rscpAu-ToolbarTitle").textContent=t.contentTitle,void 0!==w.get("topParams").cc&&""!==w.get("topParams").cc&&document.documentElement.setAttribute("lang",w.get("topParams").cc),null!==w.get("langDirection")&&document.documentElement.setAttribute("dir",w.get("langDirection"));try{s=g.getReturnURL()}catch(e){return void auRunner.displayError("Unable to get returnUrl from cmi5 object: "+e)}loadSupportFiles(function(e,t){var n,r=[],o="application/pdf"===e,i="audio/mpeg"===e,a="video/mp4"===e,u="youtube"===e,l="vimeo"===e,s=-1===e.indexOf("/")?e:e.split("/")[1];for(document.getElementById("mediaContent").classList.add(s),o?r.push("../style/pdf_viewer.css","../js/mediaFileSupport/pdfContent-min.js"):i||a?i||"videojs"!==w.get("audioVideoPlayer")?r.push("../js/mediaFileSupport/audioVideoContentNative-min.js"):(r.push("../js/mediaFileSupport/audioVideoContentVideoJS-min.js"),r.push("../style/video-js.min.css"),r.push("../style/material-icons.css"),r.push("../style/videojsPlayerPlaybackControl.css")):u?r.push("../js/mediaFileSupport/youTubeContent-min.js"):l?r.push("../js/mediaFileSupport/vimeoContent-min.js","https://player.vimeo.com/api/player.js"):void 0!==t&&r.push("../js/mediaFileSupport/webContent-min.js"),""!==w.get("mediaContentStylesheet")&&r.push(w.get("mediaContentStylesheet")),o&&d(w.get("pdfContentStylesheet"),r)&&r.push(w.get("pdfContentStylesheet")),(i||a)&&d(w.get("audioVideoContentStylesheet"),r)&&r.push(w.get("audioVideoContentStylesheet")),n=0;n<r.length;n+=1)r[n]=p(r[n]);return r}(t.MIMEType,t.launchUrl),function(e){null===e?(auRunner.initializeUI(t,{forceNewWindow:w.get("webContentForceNewWindow"),pageViewedThreshold:w.get("pdfPageViewThreshold"),pdfDownloadButton:w.get("pdfDownloadButton"),pdfContentScaling:w.get("pdfContentScaling"),activityId:g.getActivity().id,audioVideoPlayer:w.get("audioVideoPlayer"),audioVideoPlayerCfg:{qualityLevelSources:t.qualityLevelSources,seekForward:w.get("seekForward"),seekBackward:w.get("seekBackward"),playbackRates:w.get("playbackRates"),posterImage:w.get("posterImage")}},function(e){var r;null===e?(u(),r=function(e){var t;null===e?(t={userAgent:navigator.userAgent,completionThreshold:E,sessionId:g.getSessionId()},auRunner.generateCustomInitializeProperties({},t).then(function(e){g.initialize(function(e){null===e?(y=!0,window.addEventListener("beforeunload",a),window.addEventListener("unload",a),window.addEventListener("pagehide",a),auRunner.bindMedia(),l=setInterval(i,1e3),auRunner.postInitialize()):auRunner.displayError("Encountered an error initializing AU session: "+e)},e)})):auRunner.displayError("Error setting current status from a previously stored state: "+e)},g.getLRS().retrieveState("mediaContentStatus",{agent:v.agent,activity:v.activity,registration:v.registration,callback:function(e,t){var n=null;if(null!==e)return r(e);if(!t)return r(null);try{n=JSON.parse(t.contents)}catch(e){return r(e)}f=n.isComplete,auRunner.loadStateData(n,r)}})):auRunner.displayError("Error initializing the UI: "+e)}),loadSupportFiles(function(e){var t,n=[];for("youtube"===e&&n.push("https://www.youtube.com/iframe_api"),t=0;t<n.length;t+=1)n[t]=p(n[t]);return n}(t.MIMEType),function(e){null!==e&&auRunner.displayError("Error loading content support files: "+e)})):auRunner.displayError("Error loading content support files: "+e)})}else auRunner.displayError("Error calling the cmi5.start() method: "+e)},null,{breakBeforeInitializeStatement:!0})}();
//# sourceMappingURL=cmi5-mediaFile-min.js.map